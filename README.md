# ğŸŒ Discord Translation Bot (Multi-Language Support)

[![Discord.py](https://img.shields.io/badge/discord.py-v2.3.0+-blue.svg)](https://discordpy.readthedocs.io/en/stable/)
[![DeepL](https://img.shields.io/badge/Main_Engine-DeepL_API-002E3B.svg)](https://www.deepl.com/)
[![MyMemory](https://img.shields.io/badge/Fallback-MyMemory_API-red.svg)](https://mymemory.translated.net/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

å›½æ——çµµæ–‡å­—ï¼ˆãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€Discordãƒãƒ£ãƒ³ãƒãƒ«ã®ç™ºè¨€ã‚’è‡ªå‹•ç¿»è¨³ã—ã¦ã‚¹ãƒ¬ãƒƒãƒ‰ã«æŠ•ç¨¿ã™ã‚‹é«˜ç²¾åº¦ãƒ»å¤šæ©Ÿèƒ½ãªç¿»è¨³ãƒœãƒƒãƒˆã§ã™ã€‚

---

## âœ¨ ä¸»ãªæ©Ÿèƒ½

- ğŸš© **å›½æ——ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¿»è¨³**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å›½æ——ï¼ˆğŸ‡ºğŸ‡¸ ğŸ‡¯ğŸ‡µ ğŸ‡«ğŸ‡· ç­‰ï¼‰ã§ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹ã ã‘ã§å³åº§ã«ç¿»è¨³
- ğŸ’¬ **ã‚¹ãƒ¬ãƒƒãƒ‰ç®¡ç†**: ç¿»è¨³çµæœã¯å°‚ç”¨ã‚¹ãƒ¬ãƒƒãƒ‰ã«é›†ç´„ã€‚å…ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ±šã•ãšã€ä¼šè©±ã®é‚ªé­”ã‚’ã—ã¾ã›ã‚“
- ğŸ”’ **è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚º**: ç¿»è¨³æŠ•ç¨¿å¾Œã¯ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã—ã€ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ã‚¹ãƒƒã‚­ãƒªä¿ã¡ã¾ã™
- ğŸ¤– **ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚¨ãƒ³ã‚¸ãƒ³å¯¾å¿œ**: 
    - **DeepL API Free** (é«˜å“è³ªãƒ»æœˆ50ä¸‡æ–‡å­—ã¾ã§ç„¡æ–™) ã‚’ãƒ¡ã‚¤ãƒ³ã«ä½¿ç”¨
    - éå¯¾å¿œè¨€èªã‚„åˆ¶é™è¶…éæ™‚ã¯ **MyMemory API** (å…¬å¼ãƒ»ç„¡æ–™) ã«è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- ğŸ” **è¨€èªè‡ªå‹•æ¤œçŸ¥**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚½ãƒ¼ã‚¹è¨€èªã‚’è‡ªå‹•åˆ¤åˆ¥ã€‚å¤šå›½ç±ãªã‚µãƒ¼ãƒãƒ¼ã§ã‚‚è¨­å®šä¸è¦ã§å‹•ä½œã—ã¾ã™
- âš¡ **é‡è¤‡é˜²æ­¢**: åŒã˜è¨€èªã¸ã®ç¿»è¨³ã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã€APIæ¶ˆè²»ã¨é€šçŸ¥ã‚’æœ€å°é™ã«æŠ‘ãˆã¾ã™

---

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. æº–å‚™
```bash
git clone https://github.com/Syaas/translate_discordbot.git
cd translate_discordbot
pip install -r requirements.txt
```

### 2. Discord Botã®è¨­å®š
1. [Discord Developer Portal](https://discord.com/developers/applications) ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆã€‚
2. **Bot** ã‚¿ãƒ–ã§ `Privileged Gateway Intents` -> `MESSAGE CONTENT INTENT` ã‚’ã‚ªãƒ³ã€‚
3. **Bot Token** ã‚’å–å¾—ã€‚

### 3. APIã‚­ãƒ¼ã®æº–å‚™
- **DeepL API**: [DeepL API Free](https://www.deepl.com/ja/pro-api) ã§ã‚­ãƒ¼ã‚’å–å¾—ï¼ˆç„¡æ–™ï¼‰ã€‚
- **MyMemory API**: è¨­å®šãªã—ã§ã‚‚å‹•ãã¾ã™ãŒã€[å…¬å¼ã‚µã‚¤ãƒˆ](https://mymemory.translated.net/)ã§ãƒ¡ãƒ¼ãƒ«ç™»éŒ²ã™ã‚‹ã¨ç„¡æ–™æ ãŒ 5,000 â†’ 50,000æ–‡å­—/æ—¥ã«å¢—é‡ã•ã‚Œã¾ã™ã€‚

### 4. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
`.env.example` ã‚’ `.env` ã«ã‚³ãƒ”ãƒ¼ã—ã¦ç·¨é›†ã—ã¦ãã ã•ã„ã€‚
```env
DISCORD_TOKEN=your_discord_bot_token_here
DEEPL_API_KEY=your_deepl_api_key_here      # ã‚ªãƒ—ã‚·ãƒ§ãƒ³
MYMEMORY_EMAIL=your_email@example.com      # ã‚ªãƒ—ã‚·ãƒ§ãƒ³
```

---

## ğŸ“– ä½¿ã„æ–¹

1. ç¿»è¨³ã—ãŸã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å›½æ——çµµæ–‡å­—ã§ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‚
2. ãƒœãƒƒãƒˆãŒã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œæˆã—ã€ç¿»è¨³å†…å®¹ã‚’æŠ•ç¨¿ã—ã¾ã™ã€‚
3. æŠ•ç¨¿å®Œäº†å¾Œã€ã‚¹ãƒ¬ãƒƒãƒ‰ã¯è‡ªå‹•çš„ã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚Œã¾ã™ã€‚

> **TIP**: åŒã˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åˆ¥ã®å›½æ——ã‚’ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹ã¨ã€ã‚¯ãƒ­ãƒ¼ã‚ºã•ã‚ŒãŸã‚¹ãƒ¬ãƒƒãƒ‰ãŒè‡ªå‹•çš„ã«å†é–‹ã•ã‚Œã¦è¿½åŠ ç¿»è¨³ãŒæŠ•ç¨¿ã•ã‚Œã€å†ã³ã‚¯ãƒ­ãƒ¼ã‚ºã•ã‚Œã¾ã™ã€‚

---

## ğŸ›  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```text
.
â”œâ”€â”€ main.py              # ãƒœãƒƒãƒˆèµ·å‹•ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆï¼ˆãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼å«ã‚€ï¼‰
â”œâ”€â”€ cogs/
â”‚   â””â”€â”€ translator.py    # ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³åˆ¶å¾¡ãƒ»ã‚¹ãƒ¬ãƒƒãƒ‰ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ flag_map.py      # çµµæ–‡å­—ã¨è¨€èªã‚³ãƒ¼ãƒ‰ã®å®šç¾©
â”‚   â””â”€â”€ translator.py    # ç¿»è¨³ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆAPI (DeepL/MyMemory)
â”œâ”€â”€ Dockerfile           # Docker ãƒ“ãƒ«ãƒ‰è¨­å®š
â”œâ”€â”€ fly.toml             # Fly.io è¨­å®š
â”œâ”€â”€ deploy_cloudrun.sh   # GCP Cloud Run ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ set_fly_secrets.sh   # Fly.io ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç™»éŒ²ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ set_gcp_secrets.sh   # GCP Secret Manager ç™»éŒ²ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ requirements.txt     # Pythonä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
```

---

## ğŸ’° ã‚³ã‚¹ãƒˆãƒ»åˆ¶é™

| ã‚¨ãƒ³ã‚¸ãƒ³ | è²»ç”¨ | å®Ÿè³ªä¸Šé™ | å®‰å®šæ€§ |
|---|---|---|---|
| DeepL API Free | **å®Œå…¨ç„¡æ–™** | 500,000 æ–‡å­— / æœˆ | â— |
| MyMemory API | **å®Œå…¨ç„¡æ–™** | 5,000 ~ 50,000 æ–‡å­— / æ—¥ | â—‹ |

---

## ãƒ‡ãƒ—ãƒ­ã‚¤ (Fly.io)

æœ¬ãƒœãƒƒãƒˆã¯ [Fly.io](https://fly.io/) ãªã©ã® Docker å¯¾å¿œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚

### 1. Fly.io CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ãƒ­ã‚°ã‚¤ãƒ³
```bash
curl -L https://fly.io/install.sh | sh
fly auth login
```

### 2. ã‚¢ãƒ—ãƒªã®ä½œæˆã¨è¨­å®š
åˆå›ã®ã¿ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
fly launch
```
â€» `fly.toml` ãŒä½œæˆã•ã‚Œã¾ã™ã€‚æ—¢å­˜ã®ã‚‚ã®ã‚’ä½¿ã†å ´åˆã¯ `fly deploy` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 3. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆç’°å¢ƒå¤‰æ•°ï¼‰ã®è¨­å®š
`.env` ã®å†…å®¹ã‚’ Fly.io ã«ç™»éŒ²ã—ã¾ã™ã€‚æ©Ÿå¯†æƒ…å ±ã®ãŸã‚ã€ä¸€æ‹¬è¨­å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚
```bash
chmod +x set_fly_secrets.sh
./set_fly_secrets.sh
```
â€» æ‰‹å‹•ã§è¨­å®šã™ã‚‹å ´åˆã¯ `fly secrets set DISCORD_TOKEN="..."` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 4. ãƒã‚·ãƒ³æ•°ã®èª¿æ•´ï¼ˆ1å°ã«ã™ã‚‹ï¼‰
Fly.io ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ 2å°ï¼ˆé«˜å¯ç”¨æ€§ï¼‰èµ·å‹•ã—ã¾ã™ãŒã€å€‹äººç”¨ãƒœãƒƒãƒˆã§ã‚ã‚Œã° 1å°ã§ååˆ†ã§ã™ã€‚
```bash
fly scale count 1
```

### 5. ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ
```bash
fly deploy
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤ (GCP Cloud Run)

GCP Cloud Run ã§ã‚‚ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚Cloud Run ã®ã€ŒAlways-on CPUã€ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã„ã€Discord ãƒœãƒƒãƒˆã‚’å¸¸æ™‚ç¨¼åƒã•ã›ã¾ã™ã€‚

### å‰ææ¡ä»¶
- [Google Cloud SDK (`gcloud`)](https://cloud.google.com/sdk/docs/install) ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»èªè¨¼æ¸ˆã¿
- Docker ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆæ¸ˆã¿

### 1. GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸè¨­å®š
```bash
# ãƒ­ã‚°ã‚¤ãƒ³ã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
gcloud auth login
gcloud config set project YOUR_PROJECT_ID

# å¿…è¦ãª API ã‚’æœ‰åŠ¹åŒ–
gcloud services enable \
  run.googleapis.com \
  artifactregistry.googleapis.com \
  secretmanager.googleapis.com
```

### 2. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ç™»éŒ²
`.env` ã®å†…å®¹ã‚’ GCP Secret Manager ã«ç™»éŒ²ã—ã¾ã™ã€‚
```bash
chmod +x set_gcp_secrets.sh
./set_gcp_secrets.sh
```

### 3. ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿè¡Œ
ãƒ“ãƒ«ãƒ‰ â†’ ãƒ—ãƒƒã‚·ãƒ¥ â†’ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
chmod +x deploy_cloudrun.sh
./deploy_cloudrun.sh
```

> **NOTE**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¯ `asia-northeast1`ï¼ˆæ±äº¬ï¼‰ã§ã™ã€‚å¤‰æ›´ã™ã‚‹å ´åˆã¯ `./deploy_cloudrun.sh YOUR_PROJECT_ID us-central1` ã®ã‚ˆã†ã«æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

### 4. ãƒ­ã‚°ã®ç¢ºèª
```bash
gcloud run services logs read translate-discordbot --region=asia-northeast1
```

### ã‚³ã‚¹ãƒˆç›®å®‰
Cloud Run ã® Always-on CPUï¼ˆ1 vCPU / 512MB / æœ€å°1å°ï¼‰ã§ãŠãŠã‚ˆã **æœˆé¡ $5ã€œ10** ç¨‹åº¦ã§ã™ã€‚

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
[MIT License](LICENSE)

